<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BSRSDigital - Professional Digital Solutions</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Light grey background */
            color: #334155; /* Dark slate text */
            scroll-behavior: smooth; /* Smooth scrolling for anchor links */
            padding-top: 56px; /* Adjusted to prevent content from going under fixed header. */
            transition: background-color 0.3s ease, color 0.3s ease; /* Smooth theme transition */
        }
        .container-padding {
            padding-left: 1rem; /* px-4 */
            padding-right: 1rem; /* px-4 */
        }
        @media (min-width: 640px) { /* sm breakpoint */
            .container-padding {
                padding-left: 1.5rem; /* sm:px-6 */
                padding-right: 1.5rem; /* sm:px-6 */
            }
        }
        @media (min-width: 1024px) { /* lg breakpoint */
            .container-padding {
                padding-left: 2rem; /* lg:px-8 */
                padding-right: 2rem; /* lg:px-8 */
            }
        }
        /* Modal styles (for login/register and contact forms) */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1000; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.7); /* Black w/ opacity */
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 2.5rem;
            border-radius: 0.5rem;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            position: relative;
        }
        .close-button {
            color: #aaa;
            position: absolute;
            top: 1rem;
            right: 1.5rem;
            font-size: 1.75rem;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }
        .close-button:hover,
        .close-button:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Dark Mode Styles */
        body.dark-mode {
            background-color: #1a202c; /* Dark background */
            color: #e2e8f0; /* Light text */
        }
        body.dark-mode header {
            background-color: #2d3748; /* Darker header */
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px 0 rgba(0, 0, 0, 0.18);
        }
        body.dark-mode header a, body.dark-mode header button:not(#loginButton):not(#signupButton) {
            color: #cbd5e0;
        }
        body.dark-mode header a:hover, body.dark-mode header button:not(#loginButton):not(#signupButton):hover {
            color: #63b3ed;
        }
        body.dark-mode .bg-white {
            background-color: #2d3748;
        }
        body.dark-mode .bg-gray-100 {
            background-color: #4a5568;
        }
        body.dark-mode .bg-gray-50 {
            background-color: #2d3748;
        }
        body.dark-mode .bg-blue-50 {
            background-color: #2a4365;
        }
        body.dark-mode .bg-indigo-50 {
            background-color: #3f3f46;
        }
        /* Crucial fix for text colors, including h1, h2, h3 and other elements using Tailwind text-gray classes */
        body.dark-mode .text-gray-800 {
            color: #edf2f7 !important; /* Force light color for elements with text-gray-800 in dark mode */
        }
        body.dark-mode .text-gray-600 {
            color: #cbd5e0 !important; /* Force lighter color for elements with text-gray-600 in dark mode */
        }
        body.dark-mode .text-gray-700 {
            color: #cbd5e0 !important; /* Force lighter color for elements with text-gray-700 in dark mode */
        }

        body.dark-mode .border-gray-300 {
            border-color: #4a5568;
        }
        body.dark-mode input, body.dark-mode textarea {
            background-color: #4a5568;
            color: #e2e8f0;
            border-color: #636b77;
        }
        body.dark-mode input::placeholder, body.dark-mode textarea::placeholder {
            color: #a0aec0;
        }
        body.dark-mode .modal-content {
            background-color: #2d3748;
            color: #e2e8f0;
        }
        body.dark-mode .modal-content .text-gray-800 {
            color: #e2e8f0;
        }
        body.dark-mode .modal-content .text-gray-700 {
            color: #cbd5e0;
        }
        body.dark-mode footer {
            background-color: #1a202c;
        }
        body.dark-mode .shadow-sm {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px 0 rgba(0, 0, 0, 0.18);
        }
        body.dark-mode .shadow-md {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.18);
        }
        body.dark-mode .shadow-lg {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.18);
        }
        body.dark-mode .shadow-inner {
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.3);
        }
        body.dark-mode .text-gray-500 {
            color: #a0aec0;
        }
        body.dark-mode .text-blue-600 {
            color: #63b3ed; /* Lighter blue for dark mode links */
        }
        body.dark-mode .text-red-600 {
            color: #fc8181; /* Lighter red for dark mode logout */
        }
        /* Theme icon active state */
        .theme-icon.active {
            color: #4299e1; /* A distinct blue for active state */
        }
        body.dark-mode .theme-icon.active {
            color: #63b3ed; /* Lighter blue for active state in dark mode */
        }

        /* Chatbot Floating Action Button (FAB) */
        .chatbot-fab {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #2563eb; /* Blue-600 */
            color: white;
            border-radius: 9999px; /* Full rounded */
            padding: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            cursor: pointer;
            z-index: 999; /* Below modals, above other content */
            transition: background-color 0.3s ease;
            display: flex; /* To center the icon */
            justify-content: center; /* To center the icon */
            align-items: center; /* To center the icon */
            overflow: hidden; /* Ensure content doesn't spill out */
        }
        .chatbot-fab:hover {
            background-color: #1d4ed8; /* Blue-700 */
        }
        body.dark-mode .chatbot-fab {
            background-color: #63b3ed; /* Lighter blue for dark mode */
        }
        body.dark-mode .chatbot-fab:hover {
            background-color: #4299e1;
        }
        .chatbot-fab svg {
            width: 24px; /* Adjust size as needed */
            height: 24px; /* Adjust size as needed */
            fill: currentColor; /* Ensure SVG color matches text color (white) */
        }


        /* Chatbot Widget Styles */
        #neuraXChatbotWidget {
            position: fixed;
            bottom: 90px; /* Above the FAB */
            right: 20px;
            width: 350px; /* Square-ish width */
            height: 450px; /* Square-ish height */
            max-width: 90vw; /* Responsive for smaller screens */
            max-height: 80vh; /* Responsive for smaller screens */
            background-color: #ffffff;
            border-radius: 0.75rem; /* rounded-lg */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            z-index: 998; /* Below modals, above FAB */
            transform: translateY(100%); /* Start hidden below screen */
            opacity: 0;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
        }
        #neuraXChatbotWidget.open {
            transform: translateY(0); /* Slide up */
            opacity: 1;
        }
        body.dark-mode #neuraXChatbotWidget {
            background-color: #2d3748; /* Darker background for widget */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.18);
        }

        #neuraXChatbotWidget .chat-header {
            background-color: #2563eb; /* Blue-600 */
            color: white;
            padding: 0.75rem 1rem;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top-left-radius: 0.75rem;
            border-top-right-radius: 0.75rem;
        }
        body.dark-mode #neuraXChatbotWidget .chat-header {
            background-color: #63b3ed; /* Lighter blue for dark mode */
        }

        #neuraXChatbotWidget .chat-messages {
            flex-grow: 1;
            padding: 1rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            font-size: 0.875rem; /* text-sm */
            line-height: 1.25rem;
        }
        #neuraXChatbotWidget .chat-input-area {
            display: flex;
            padding: 1rem;
            border-top: 1px solid #e2e8f0; /* gray-200 */
        }
        body.dark-mode #neuraXChatbotWidget .chat-input-area {
            border-top-color: #4a5568; /* Darker border */
        }

        #neuraXChatbotWidget .chat-input {
            flex-grow: 1;
            border: 1px solid #cbd5e0; /* gray-300 */
            border-radius: 0.375rem; /* rounded-md */
            padding: 0.5rem 0.75rem;
            font-size: 0.875rem;
            line-height: 1.25rem;
            margin-right: 0.5rem;
            background-color: #f8fafc; /* Light gray background */
            color: #334155;
        }
        body.dark-mode #neuraXChatbotWidget .chat-input {
            background-color: #4a5568;
            border-color: #636b77;
            color: #e2e8f0;
        }
        #neuraXChatbotWidget .chat-input::placeholder {
            color: #94a3b8; /* slate-400 */
        }

        #neuraXChatbotWidget .chat-send-button {
            background-color: #2563eb; /* Blue-600 */
            color: white;
            border-radius: 0.375rem; /* rounded-md */
            padding: 0.5rem 1rem;
            font-weight: 600;
            transition: background-color 0.3s ease;
        }
        #neuraXChatbotWidget .chat-send-button:hover {
            background-color: #1d4ed8; /* Blue-700 */
        }
        body.dark-mode #neuraXChatbotWidget .chat-send-button {
            background-color: #63b3ed;
        }
        body.dark-mode #neuraXChatbotWidget .chat-send-button:hover {
            background-color: #4299e1;
        }

        .chat-message-user {
            align-self: flex-end;
            background-color: #dbeafe; /* blue-100 */
            padding: 0.5rem 0.75rem;
            border-radius: 0.75rem;
            max-width: 80%;
        }
        body.dark-mode .chat-message-user {
            background-color: #3b82f6; /* blue-500 */
            color: white;
        }

        .chat-message-bot {
            align-self: flex-start;
            background-color: #e2e8f0; /* gray-200 */
            padding: 0.5rem 0.75rem;
            border-radius: 0.75rem;
            max-width: 80%;
        }
        body.dark-mode .chat-message-bot {
            background-color: #4a5568; /* gray-700 */
            color: #e2e8f0;
        }
        .chat-message-bot.loading {
            display: flex;
            align-items: center;
        }
        .chat-message-bot.loading .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #94a3b8;
            margin: 0 2px;
            animation: bounce 1.4s infinite ease-in-out both;
        }
        .chat-message-bot.loading .dot:nth-child(1) { animation-delay: -0.32s; }
        .chat-message-bot.loading .dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1.0); }
        }
    </style>
</head>
<body class="antialiased">
    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, collection, query, where, getDocs, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Global Firebase variables
        let app, auth, db, userId = null;

        document.addEventListener('DOMContentLoaded', async () => {
            const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);

            // Google Auth Provider
            const googleProvider = new GoogleAuthProvider();

            // Function to handle Google Sign-In
            async function signInWithGoogle() {
                try {
                    const result = await signInWithPopup(auth, googleProvider);
                    // This gives you a Google Access Token. You can use it to access the Google API.
                    const credential = GoogleAuthProvider.credentialFromResult(result);
                    const token = credential.accessToken;
                    // The signed-in user info.
                    const user = result.user;
                    console.log("User logged in with Google:", user);

                    // Optionally, create a user document in Firestore if it doesn't exist
                    const userProfileRef = doc(db, `artifacts/${__app_id}/users/${user.uid}/profile/`, 'user_info');
                    const userProfileSnap = await getDoc(userProfileRef);
                    if (!userProfileSnap.exists()) {
                        await setDoc(userProfileRef, {
                            email: user.email,
                            displayName: user.displayName,
                            photoURL: user.photoURL,
                            createdAt: new Date(),
                            authMethod: 'google'
                        });
                    }

                    // Close login modal
                    const loginRegisterModal = document.getElementById('loginRegisterModal');
                    if (loginRegisterModal) {
                        loginRegisterModal.classList.add('hidden');
                        loginRegisterModal.style.display = 'none';
                    }
                } catch (error) {
                    console.error("Error during Google Sign-In:", error);
                    const authMessage = document.getElementById('authMessage');
                    // Display a user-friendly message based on the error code
                    let errorMessage = "Google Sign-In failed. Please try again.";
                    if (error.code === 'auth/popup-closed-by-user') {
                        errorMessage = "Sign-in window closed. Please try again.";
                    } else if (error.code === 'auth/cancelled-popup-request') {
                        errorMessage = "Sign-in already in progress or blocked. Please try again.";
                    } else if (error.code === 'auth/operation-not-allowed') {
                        errorMessage = "Google Sign-In is not enabled for this Firebase project. Contact support.";
                    } else if (error.code === 'auth/unauthorized-domain') {
                        errorMessage = "Your website's domain is not authorized for Google Sign-In in Firebase. Check Firebase console settings.";
                    }
                    if (authMessage) authMessage.textContent = `Error: ${errorMessage}`;
                }
            }

            // Event listener for Google Sign-In button
            const googleSignInButton = document.getElementById('googleSignInButton');
            if (googleSignInButton) {
                googleSignInButton.addEventListener('click', signInWithGoogle);
            }

            // Initial authentication check
            onAuthStateChanged(auth, async (user) => {
                const loginButton = document.getElementById('loginButton');
                const signupButton = document.getElementById('signupButton');
                const userProfileMenu = document.getElementById('userProfileMenu');
                const displayUserId = document.getElementById('displayUserId');
                const personalDashboard = document.getElementById('personal-dashboard');

                if (user) {
                    userId = user.uid;
                    console.log("User is logged in:", user.email, "UID:", userId);
                    if (loginButton) loginButton.classList.add('hidden');
                    if (signupButton) signupButton.classList.add('hidden');
                    if (userProfileMenu) userProfileMenu.classList.remove('hidden');
                    if (displayUserId) displayUserId.textContent = `User ID: ${userId}`;
                    if (personalDashboard) personalDashboard.classList.remove('hidden');
                    
                    // Check if the user has a personal space document
                    const userSpaceDocRef = doc(db, `artifacts/${__app_id}/users/${userId}/personal_space/`, 'my_data');
                    const userSpaceDoc = await getDoc(userSpaceDocRef);
                    const userSpaceContent = document.getElementById('userSpaceContent');
                    if (userSpaceDoc.exists()) {
                        console.log("User personal space data:", userSpaceDoc.data());
                        if (userSpaceContent) userSpaceContent.textContent = JSON.stringify(userSpaceDoc.data(), null, 2);
                    } else {
                        console.log("User personal space does not exist, creating a default one.");
                        await setDoc(userSpaceDocRef, { welcomeMessage: `Welcome to your personal space, ${user.displayName || user.email}!`, timestamp: new Date() });
                        if (userSpaceContent) userSpaceContent.textContent = JSON.stringify({ welcomeMessage: `Welcome to your personal space, ${user.displayName || user.email}!`, timestamp: new Date() }, null, 2);
                    }
                } else {
                    userId = null;
                    console.log("User is logged out or anonymous.");
                    if (loginButton) loginButton.classList.remove('hidden');
                    if (signupButton) signupButton.classList.remove('hidden');
                    if (userProfileMenu) userProfileMenu.classList.add('hidden');
                    if (personalDashboard) personalDashboard.classList.add('hidden'); // Hide personal dashboard
                    
                    // Attempt anonymous login if no initial auth token
                    const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
                    if (initialAuthToken) {
                        try {
                            await signInWithCustomToken(auth, initialAuthToken);
                            console.log("Signed in with custom token.");
                        } catch (tokenError) {
                            console.error("Error signing in with custom token:", tokenError);
                            try {
                                await signInAnonymously(auth);
                                console.log("Signed in anonymously due to custom token error.");
                            } catch (anonError) {
                                console.error("Error signing in anonymously:", anonError);
                            }
                        }
                    } else {
                        try {
                            await signInAnonymously(auth);
                            console.log("Signed in anonymously (no custom token provided).");
                        } catch (anonError) {
                            console.error("Error signing in anonymously:", anonError);
                        }
                    }
                }
            });

            // Logout function
            window.logoutUser = async () => {
                try {
                    await signOut(auth);
                    console.log("User signed out successfully."); // Added confirmation log
                    // Reset UI
                    const loginButton = document.getElementById('loginButton');
                    const signupButton = document.getElementById('signupButton');
                    const userProfileMenu = document.getElementById('userProfileMenu');
                    const personalDashboard = document.getElementById('personal-dashboard');

                    if (loginButton) loginButton.classList.remove('hidden');
                    if (signupButton) signupButton.classList.remove('hidden');
                    if (userProfileMenu) userProfileMenu.classList.add('hidden');
                    if (personalDashboard) personalDashboard.classList.add('hidden');
                } catch (error) {
                    console.error("Error signing out:", error);
                }
            };

            // Theme switching logic
            const themeToggleSun = document.getElementById('themeToggleSun');
            const themeToggleMoon = document.getElementById('themeToggleMoon');
            // Mobile theme toggles
            const mobileThemeToggleSun = document.getElementById('mobileThemeToggleSun');
            const mobileThemeToggleMoon = document.getElementById('mobileThemeToggleMoon');

            const body = document.body;

            function updateThemeIcons(activeTheme) {
                const allThemeIcons = document.querySelectorAll('.theme-icon');
                allThemeIcons.forEach(icon => icon.classList.remove('active'));

                if (activeTheme === 'dark') {
                    if (themeToggleMoon) themeToggleMoon.classList.add('active');
                    if (mobileThemeToggleMoon) mobileThemeToggleMoon.classList.add('active');
                } else { // default or light
                    if (themeToggleSun) themeToggleSun.classList.add('active');
                    if (mobileThemeToggleSun) mobileThemeToggleSun.classList.add('active');
                }
            }

            function applyTheme(themeName) {
                body.classList.remove('dark-mode'); // Always remove dark mode first
                if (themeName === 'dark') {
                    body.classList.add('dark-mode');
                } else if (themeName === 'default' || themeName === 'light') {
                    // Default mode has no specific class, Tailwind's light mode is default
                }
                localStorage.setItem('theme', themeName); // Save preference
                updateThemeIcons(themeName); // Update active icon
            }

            // Apply saved theme on load
            const savedTheme = localStorage.getItem('theme') || 'default';
            applyTheme(savedTheme);

            if (themeToggleSun) themeToggleSun.addEventListener('click', () => applyTheme('default')); // Sun for default/light
            if (themeToggleMoon) themeToggleMoon.addEventListener('click', () => applyTheme('dark'));
            
            // Mobile theme toggles
            if (mobileThemeToggleSun) mobileThemeToggleSun.addEventListener('click', () => applyTheme('default'));
            if (mobileThemeToggleMoon) mobileThemeToggleMoon.addEventListener('click', () => applyTheme('dark'));
        });
    </script>

    <!-- Header Section -->
    <header class="bg-white shadow-sm py-2 fixed top-0 w-full z-10" id="mainHeader">
        <div class="max-w-7xl mx-auto container-padding flex justify-between items-center">
            <!-- Logo/Site Title -->
            <a href="#" class="rounded-md p-2 flex flex-col items-center">
                <span class="text-4xl font-extrabold text-blue-700 tracking-wider leading-none">BSRS</span>
                <span class="text-base text-gray-600 tracking-widest -mt-1">DIGITAL</span>
            </a>

            <!-- Navigation Links (desktop) -->
            <nav class="hidden md:flex space-x-6 items-center">
                <a href="#hero" class="text-gray-600 hover:text-blue-700 transition duration-300 ease-in-out rounded-md p-2 nav-link">Home</a>
                <a href="#about-us" class="text-gray-600 hover:text-blue-700 transition duration-300 ease-in-out rounded-md p-2 nav-link">About Us</a>
                <a href="#services" class="text-gray-600 hover:text-blue-700 transition duration-300 ease-in-out rounded-md p-2 nav-link">Services</a>
                <a href="#content" class="text-gray-600 hover:text-blue-700 transition duration-300 ease-in-out rounded-md p-2 nav-link">Content</a>
            </nav>

            <!-- Combined Theme Switcher, Get In Touch, and Auth Buttons -->
            <div class="hidden md:flex space-x-3 items-center">
                <!-- Theme Toggles -->
                <div class="flex space-x-1">
                    <button id="themeToggleSun" class="px-2 py-1 text-gray-800 rounded-full hover:bg-gray-200 dark:text-gray-300 dark:hover:bg-gray-700 transition duration-200 ease-in-out theme-icon" title="Light/Default Theme">
                        <svg class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
                        <span class="sr-only">Light/Default Theme</span>
                    </button>
                    <button id="themeToggleMoon" class="px-2 py-1 text-gray-800 rounded-full hover:bg-gray-200 dark:text-gray-300 dark:hover:bg-gray-700 transition duration-200 ease-in-out theme-icon" title="Dark Theme">
                        <svg class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
                        <span class="sr-only">Dark Theme</span>
                    </button>
                </div>
                
                <!-- "Get In Touch" button (desktop) -->
                <button class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-300 ease-in-out shadow-sm" onclick="openContactModal()">Get In Touch</button>

                <button id="loginButton" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-300 ease-in-out shadow-sm" onclick="openLoginRegisterModal()">Login</button>
                <button id="signupButton" class="px-4 py-2 border border-blue-600 text-blue-600 rounded-md hover:bg-blue-50 transition duration-300 ease-in-out shadow-sm" onclick="openLoginRegisterModal()">Sign Up</button>

                <!-- User Profile Dropdown (hidden by default) -->
                <div id="userProfileMenu" class="relative hidden">
                    <button class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition duration-300 ease-in-out flex items-center" id="userMenuButton">
                        <svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                        Profile
                    </button>
                    <div id="userMenuDropdown" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 hidden">
                        <p class="block px-4 py-2 text-sm text-gray-700" id="displayUserId">User ID: Loading...</p>
                        <a href="#personal-dashboard" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 nav-link">My Dashboard</a>
                        <button class="block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100" onclick="logoutUser()">Logout</button>
                    </div>
                </div>
            </div>

            <!-- Mobile Menu Button -->
            <button class="md:hidden text-gray-600 hover:text-blue-700 focus:outline-none" id="mobileMenuToggle">
                <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
            </button>
        </div>
        <!-- Mobile Navigation (hidden by default, can be toggled with JS) -->
        <div id="mobileMenu" class="md:hidden bg-white shadow-lg py-2 hidden">
            <nav class="flex flex-col items-center space-y-2">
                <a href="#hero" class="block px-4 py-2 text-gray-600 hover:bg-gray-100 w-full text-center rounded-md nav-link">Home</a>
                <a href="#about-us" class="block px-4 py-2 text-gray-600 hover:bg-gray-100 w-full text-center rounded-md nav-link">About Us</a>
                <a href="#services" class="block px-4 py-2 text-gray-600 hover:bg-gray-100 w-full text-center rounded-md nav-link">Services</a>
                <a href="#content" class="block px-4 py-2 text-gray-600 hover:bg-gray-100 w-full text-center rounded-md nav-link">Content</a>
                <!-- Mobile Theme Toggles -->
                <div class="flex space-x-1 mt-2">
                    <button id="mobileThemeToggleSun" class="px-2 py-1 text-gray-800 rounded-full hover:bg-gray-200 dark:text-gray-300 dark:hover:bg-gray-700 transition duration-200 ease-in-out theme-icon" title="Light/Default Theme">
                        <svg class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
                        <span class="sr-only">Light/Default Theme</span>
                    </button>
                    <button id="mobileThemeToggleMoon" class="px-2 py-1 text-gray-800 rounded-full hover:bg-gray-200 dark:text-gray-300 dark:hover:bg-gray-700 transition duration-200 ease-in-out theme-icon" title="Dark Theme">
                        <svg class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
                        <span class="sr-only">Dark Theme</span>
                    </button>
                </div>
                <!-- "Get In Touch" button (mobile) -->
                <button class="w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-300 ease-in-out shadow-sm mt-2" onclick="openContactModal()">Get In Touch</button>
                <button class="w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-300 ease-in-out shadow-sm mt-2" onclick="openLoginRegisterModal()">Login</button>
                <button class="w-full px-4 py-2 border border-blue-600 text-blue-600 rounded-md hover:bg-blue-50 transition duration-300 ease-in-out shadow-sm mt-1" onclick="openLoginRegisterModal()">Sign Up</button>
                <button class="block w-full text-left px-4 py-2 text-red-600 hover:bg-gray-100" onclick="logoutUser()">Logout</button>
            </nav>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="max-w-7xl mx-auto container-padding py-12">
        <!-- Hero Section -->
        <section id="hero" class="text-center mb-16 py-20 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg shadow-inner">
            <h1 class="text-5xl font-extrabold text-gray-800 mb-4">Empowering Your Digital Journey</h1>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto mb-8">BSRSDigital provides cutting-edge solutions and rich content to elevate your skills and business online.</p>
            <a href="#services" class="px-8 py-3 bg-blue-600 text-white text-lg font-semibold rounded-md hover:bg-blue-700 transition duration-300 ease-in-out shadow-lg nav-link">Explore Our Services</a>
        </section>

        <!-- About Us Section -->
        <section id="about-us" class="mb-16 py-12">
            <h2 class="text-4xl font-bold text-gray-800 text-center mb-8">About BSRSDigital</h2>
            <div class="bg-white p-8 rounded-lg shadow-md max-w-4xl mx-auto">
                <p class="text-lg text-gray-700 mb-4">
                    At BSRSDigital, we are passionate about guiding individuals and businesses through the ever-evolving digital landscape. With a decade of experience in crafting impactful online presences and delivering high-value digital solutions, we understand what it takes to succeed.
                </p>
                <p class="text-lg text-gray-700">
                    Our mission is to empower you with the knowledge, tools, and strategies needed to thrive online, whether you're looking to enhance your professional skills, grow your business, or simply navigate the digital world more effectively.
                </p>
            </div>
        </section>

        <!-- Services Section (formerly part of the content section) -->
        <section id="services" class="mb-16 py-12 bg-blue-50 rounded-lg shadow-inner">
            <h2 class="text-4xl font-bold text-gray-800 text-center mb-10">Why Explore Our Services?</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto">
                <!-- Service Card 1 -->
                <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow duration-300 ease-in-out">
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Expert Web Development</h3>
                    <p class="text-gray-600 text-sm">Crafting responsive, high-performance websites tailored to your unique needs and brand identity.</p>
                </div>
                <!-- Service Card 2 -->
                <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow duration-300 ease-in-out">
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Strategic Digital Marketing</h3>
                    <p class="text-gray-600 text-sm">Driving growth through SEO, social media, content marketing, and paid advertising campaigns.</p>
                </div>
                <!-- Service Card 3 -->
                <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow duration-300 ease-in-out">
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Tailored Digital Consulting</h3>
                    <p class="text-gray-600 text-sm">Providing expert guidance to optimize your digital strategy and achieve your business objectives.</p>
                </div>
                <!-- Add more service cards as needed -->
                <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow duration-300 ease-in-out">
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Rich Content Creation</h3>
                    <p class="text-gray-600 text-sm">Developing engaging articles, tutorials, and resources to inform and captivate your audience.</p>
                </div>
                <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow duration-300 ease-in-out">
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Analytics & Performance</h3>
                    <p class="text-gray-600 text-sm">Tracking, analyzing, and optimizing your digital presence for maximum impact and ROI.</p>
                </div>
                <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow duration-300 ease-in-out">
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Secure Cloud Solutions</h3>
                    <p class="text-gray-600 text-sm">Implementing robust and scalable cloud-based solutions for your backend and data.</p>
                </div>
            </div>
            <div class="text-center mt-12">
                <a href="#contact" class="px-6 py-3 border border-blue-600 text-blue-600 rounded-md hover:bg-blue-50 transition duration-300 ease-in-out shadow-sm nav-link">Get a Free Consultation</a>
            </div>
        </section>


        <!-- Content Access / Authentication Section (Reframed) -->
        <section class="bg-white p-8 rounded-lg shadow-md mb-16 flex flex-col md:flex-row items-center justify-between">
            <div class="md:w-1/2 text-center md:text-left mb-6 md:mb-0">
                <h2 class="text-3xl font-bold text-gray-800 mb-3">Access Exclusive Content & Resources</h2>
                <p class="text-gray-600">Explore a wealth of articles, tutorials, and guides. Some premium content requires secure email verification for access. Many resources are available for free!</p>
            </div>
            <div class="md:w-1/2 flex flex-col items-center">
                <div class="w-full max-w-sm">
                    <button class="w-full px-5 py-3 bg-green-600 text-white font-semibold rounded-md hover:bg-green-700 transition duration-300 ease-in-out shadow-md" onclick="openLoginRegisterModal()">Get Started / Create Account</button>
                    <p class="text-sm text-gray-500 mt-2 text-center">Already have an account? <a href="#" class="text-blue-600 hover:underline" onclick="openLoginRegisterModal()">Login here</a></p>
                </div>
            </div>
        </section>

        <!-- Our Content Structure Section (Reframed from Featured Learning Paths) -->
        <section id="content" class="mb-16 py-12 bg-gray-50 rounded-lg shadow-inner">
            <h2 class="text-4xl font-bold text-gray-800 text-center mb-10">Our Structured Content Pathways</h2>
            <p class="text-lg text-gray-700 text-center max-w-3xl mx-auto mb-10">Our content is designed to guide you through various digital topics, from foundational knowledge to advanced techniques. We offer both freely accessible resources and premium content requiring registration.</p>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Content Card 1: Free Introduction -->
                <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300 ease-in-out">
                    <img src="https://placehold.co/400x250/E0F2F7/283593?text=Intro+to+Web" alt="Introduction to Web" class="w-full h-48 object-cover">
                    <div class="p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-2" data-course-title="Introduction to Web Technologies">Introduction to Web Technologies</h3>
                        <p class="text-gray-600 text-sm mb-4" data-original-description="Start your digital journey with foundational concepts of web development and design. Perfect for beginners!">Start your digital journey with foundational concepts of web development and design. Perfect for beginners!</p>
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-sm font-medium text-blue-600">Beginner Level</span>
                            <span class="text-lg font-bold text-green-600">Free Access</span>
                        </div>
                        <button class="w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-300 ease-in-out mb-2">Read Article</button>
                        <button class="enhance-description-btn w-full px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition duration-300 ease-in-out" data-content-id="content1">✨ Enhance Description</button>
                    </div>
                </div>

                <!-- Content Card 2: Email Required Tutorial -->
                <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300 ease-in-out">
                    <img src="https://placehold.co/400x250/E3F2FD/1A237E?text=Advanced+SEO" alt="Advanced SEO Tutorial" class="w-full h-48 object-cover">
                    <div class="p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-2" data-course-title="Advanced SEO Strategies & Implementation">Advanced SEO Strategies & Implementation</h3>
                        <p class="text-gray-600 text-sm mb-4" data-original-description="Dive deep into search engine optimization to rank higher and drive organic traffic. Registration required.">Dive deep into search engine optimization to rank higher and drive organic traffic. Registration required.</p>
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-sm font-medium text-blue-600">Intermediate</span>
                            <span class="text-lg font-bold text-orange-600">Email Required</span>
                        </div>
                        <button class="w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-300 ease-in-out mb-2" onclick="openLoginRegisterModal()">Access Content</button>
                        <button class="enhance-description-btn w-full px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition duration-300 ease-in-out" data-content-id="content2">✨ Enhance Description</button>
                    </div>
                </div>

                <!-- Content Card 3: Premium Guide -->
                <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300 ease-in-out">
                    <img src="https://placehold.co/400x250/CFD8DC/263238?text=AI+Tools+Guide" alt="AI Tools Guide" class="w-full h-48 object-cover">
                    <div class="p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-2" data-course-title="Leveraging AI Tools for Digital Marketing">Leveraging AI Tools for Digital Marketing</h3>
                        <p class="text-gray-600 text-sm mb-4" data-original-description="An exclusive guide on integrating AI into your marketing efforts for enhanced efficiency and results. Premium access.">An exclusive guide on integrating AI into your marketing efforts for enhanced efficiency and results. Premium access.</p>
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-sm font-medium text-blue-600">Advanced</span>
                            <span class="text-lg font-bold text-orange-600">Premium Content</span>
                        </div>
                        <button class="w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-300 ease-in-out mb-2" onclick="openLoginRegisterModal()">View Guide</button>
                        <button class="enhance-description-btn w-full px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition duration-300 ease-in-out" data-content-id="content3">✨ Enhance Description</button>
                    </div>
                </div>
            </div>
            <div class="text-center mt-12">
                <button class="px-6 py-3 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition duration-300 ease-in-out shadow-sm">Browse All Content</button>
            </div>
        </section>

        <!-- Personal Dashboard Section (Hidden by default, shown after login) -->
        <section id="personal-dashboard" class="mb-16 py-12 bg-indigo-50 rounded-lg shadow-inner hidden">
            <h2 class="text-4xl font-bold text-gray-800 text-center mb-8">Your Personal Dashboard</h2>
            <div class="bg-white p-8 rounded-lg shadow-md max-w-4xl mx-auto">
                <p class="text-lg text-gray-700 mb-4">
                    Welcome to your personal space! Here you can manage your settings, track your progress, and access exclusive content.
                </p>
                <div class="bg-gray-100 p-4 rounded-md overflow-auto max-h-60">
                    <pre id="userSpaceContent" class="text-sm text-gray-800 whitespace-pre-wrap"></pre>
                </div>
                <p class="text-sm text-gray-500 mt-4">This data is stored securely in your private Firebase Firestore collection.</p>
            </div>
        </section>
    </main>

    <!-- Footer Section -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="max-w-7xl mx-auto container-padding text-center">
            <p>&copy; 2025 BSRSDigital. All rights reserved.</p>
            <div class="flex justify-center space-x-4 mt-4">
                <a href="#" class="text-gray-400 hover:text-white transition duration-300 ease-in-out">Privacy Policy</a>
                <a href="#" class="text-gray-400 hover:text-white transition duration-300 ease-in-out">Terms of Service</a>
            </div>
            <!-- Social Media Links -->
            <div class="flex justify-center space-x-6 mt-6">
                <a href="https://github.com/bijjula/airesearchlabs2025" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-blue-500 transition duration-300 ease-in-out">
                    <svg class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.44-.78-3.5.25-1.15.25-2.39 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.11 0 2.35 0 3.5A5.4 5.4 0 0 0 4 12c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg>
                    <span class="sr-only">GitHub</span>
                </a>
                <a href="#" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-blue-500 transition duration-300 ease-in-out">
                    <svg class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
                    <span class="sr-only">Facebook</span>
                </a>
                <a href="#" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-pink-500 transition duration-300 ease-in-out">
                    <svg class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><rect width="20" height="20" x="2" y="2" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" x2="17.51" y1="6.5" y2="6.5"></line></svg>
                    <span class="sr-only">Instagram</span>
                </a>
                <a href="#" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-red-500 transition duration-300 ease-in-out">
                    <svg class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 2-2h15a2 2 0 0 1 2 2 24.12 24.12 0 0 1 0 10 2 2 0 0 1-2 2H4.5a2 2 0 0 1-2-2Z"></path><path d="m10 15 5-3-5-3z"></path></svg>
                    <span class="sr-only">YouTube</span>
                </a>
                <a href="https://www.linkedin.com/in/ai-research-labs/" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-blue-600 transition duration-300 ease-in-out">
                    <svg class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect width="4" height="12" x="2" y="9"></rect><circle cx="4" cy="4" r="2"></circle></svg>
                    <span class="sr-only">LinkedIn</span>
                </a>
            </div>
        </div>
    </footer>

    <!-- Description Modal (for LLM enhanced content) -->
    <div id="descriptionModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button" id="closeModalBtn">&times;</span>
            <h3 class="text-2xl font-bold text-gray-800 mb-4" id="modalCourseTitle"></h3>
            <div id="modalDescription" class="text-gray-700">
                <!-- Enhanced description will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Login/Register Modal -->
    <div id="loginRegisterModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button" id="closeLoginRegisterModalBtn">&times;</span>
            <h3 class="text-2xl font-bold text-gray-800 mb-4 text-center" id="authTitle">Sign in to BSRSDigital</h3>
            <p id="authMessage" class="text-center text-red-500 text-sm mb-4"></p>
            <button id="googleSignInButton" class="w-full px-5 py-3 bg-blue-600 text-white font-semibold rounded-md hover:bg-blue-700 transition duration-300 ease-in-out shadow-md flex items-center justify-center">
                <svg class="w-5 h-5 mr-2" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M44.5 20H24V28.5H35.5C34.7 32.5 32 35.5 28 38V44H36C40.5 39.5 44.5 34 44.5 20Z" fill="#4285F4"/>
                    <path d="M24 44C30.6 44 36.3 41.6 40.5 38L36 31.5C33.6 33.2 30 34.5 24 34.5C18.8 34.5 14.2 31.8 11.8 27.5L6.5 31.5C9.5 37.5 16.2 44 24 44Z" fill="#34A853"/>
                    <path d="M11.8 27.5C10.8 24.8 10.8 21.2 11.8 18.5L6.5 14.5C3 19.5 3 26.5 6.5 31.5L11.8 27.5Z" fill="#FBBC05"/>
                    <path d="M24 13.5C27.2 13.5 29.8 14.7 31.8 16.5L36 12C33.6 9.5 29.6 8 24 8C16.2 8 9.5 14.5 6.5 20.5L11.8 24.5C14.2 20.2 18.8 13.5 24 13.5Z" fill="#EA4335"/>
                </svg>
                Sign in with Google
            </button>
        </div>
    </div>

    <!-- Contact Modal -->
    <div id="contactModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-button" id="closeContactModalBtn">&times;</span>
            <h3 class="text-2xl font-bold text-gray-800 mb-4 text-center">Get In Touch</h3>
            <form class="max-w-xl mx-auto space-y-6">
                <div>
                    <label for="modalName" class="block text-gray-700 text-sm font-bold mb-2">Name</label>
                    <input type="text" id="modalName" class="shadow-sm appearance-none border rounded-md w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 ease-in-out" placeholder="Your Name">
                </div>
                <div>
                    <label for="modalEmail" class="block text-gray-700 text-sm font-bold mb-2">Email</label>
                    <input type="email" id="modalEmail" class="shadow-sm appearance-none border rounded-md w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 ease-in-out" placeholder="Your Email">
                </div>
                <div>
                    <label for="modalMessage" class="block text-gray-700 text-sm font-bold mb-2">Message</label>
                    <textarea id="modalMessage" rows="5" class="shadow-sm appearance-none border rounded-md w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 ease-in-out" placeholder="Your Message"></textarea>
                </div>
                <button type="submit" class="w-full px-5 py-3 bg-blue-600 text-white font-semibold rounded-md hover:bg-blue-700 transition duration-300 ease-in-out shadow-md">Send Message</button>
            </form>
        </div>
    </div>

    <!-- Chatbot Floating Action Button (FAB) -->
    <button id="openChatbotFab" class="chatbot-fab">
        <!-- Original message SVG icon -->
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path></svg>
        <span class="sr-only">Open Chatbot</span>
    </button>

    <!-- NeuraX Chatbot Widget -->
    <div id="neuraXChatbotWidget" class="hidden">
        <div class="chat-header">
            <span>NeuraX</span>
            <button class="close-button text-white text-xl" onclick="toggleChatbot()">
                &times;
            </button>
        </div>
        <div class="chat-messages" id="chatMessages">
             <!-- Messages will be dynamically inserted here -->
        </div>
        <div class="chat-input-area">
            <input type="text" id="chatInput" class="chat-input" placeholder="Type your message...">
            <button id="chatSendButton" class="chat-send-button">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
            </button>
        </div>
    </div>


    <script>
        // Mobile Menu Toggle
        const mobileMenuToggle = document.getElementById('mobileMenuToggle');
        const mobileMenu = document.getElementById('mobileMenu');
        if (mobileMenuToggle && mobileMenu) {
            mobileMenuToggle.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
            // Close mobile menu when a link is clicked
            mobileMenu.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    mobileMenu.classList.add('hidden');
                });
            });
        }


        // User Profile Dropdown Toggle
        const userMenuButton = document.getElementById('userMenuButton');
        const userMenuDropdown = document.getElementById('userMenuDropdown');
        if (userMenuButton && userMenuDropdown) {
            userMenuButton.addEventListener('click', () => {
                userMenuDropdown.classList.toggle('hidden');
            });
            // Close dropdown if clicked outside
            window.addEventListener('click', (event) => {
                if (userMenuButton && userMenuDropdown && !userMenuButton.contains(event.target) && !userMenuDropdown.contains(event.target)) {
                    userMenuDropdown.classList.add('hidden');
                }
            });
        }

        /**
         * Smoothly scrolls to a target section on the page, accounting for a fixed header.
         * @param {Event} event The click event from the navigation link.
         */
        function scrollToSection(event) {
            event.preventDefault(); // Prevent default anchor link behavior
            const targetId = event.target.getAttribute('href');
            const targetElement = document.querySelector(targetId);

            if (targetElement) {
                const header = document.getElementById('mainHeader'); // Get the fixed header
                const headerOffset = header ? header.offsetHeight : 0; // Get its height
                const elementPosition = targetElement.getBoundingClientRect().top + window.pageYOffset;
                const offsetPosition = elementPosition - headerOffset - 10; // Adjust by header height + a little extra padding

                window.scrollTo({
                    top: offsetPosition,
                    behavior: "smooth"
                });

                // Close mobile menu if open after clicking a link
                const mobileMenu = document.getElementById('mobileMenu');
                if (mobileMenu && !mobileMenu.classList.contains('hidden')) {
                    mobileMenu.classList.add('hidden');
                }
            }
        }

        // Attach the scrollToSection function to all navigation links
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', scrollToSection);
        });


        // LLM Description Enhancement
        const enhanceButtons = document.querySelectorAll('.enhance-description-btn');
        const descriptionModal = document.getElementById('descriptionModal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const modalCourseTitle = document.getElementById('modalCourseTitle');
        const modalDescription = document.getElementById('modalDescription');

        async function callGeminiAPI(prompt, retries = 0) {
            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    if (response.status === 429 && retries < 5) {
                        const delay = Math.pow(2, retries) * 1000;
                        await new Promise(res => setTimeout(res, delay));
                        return callGeminiAPI(prompt, retries + 1);
                    }
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    return result.candidates[0].content.parts[0].text;
                } else {
                    return "Failed to generate description. Please try again.";
                }
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                return "Error generating description. Please try again later.";
            }
        }

        enhanceButtons.forEach(button => {
            button.addEventListener('click', async (event) => {
                const card = event.target.closest('.bg-white.rounded-lg.shadow-md');
                const contentTitleElement = card.querySelector('[data-course-title]');
                const originalDescriptionElement = card.querySelector('[data-original-description]');

                const contentTitle = contentTitleElement ? contentTitleElement.textContent : '';
                const originalDescription = originalDescriptionElement ? originalDescriptionElement.getAttribute('data-original-description') : '';

                if (modalCourseTitle) modalCourseTitle.textContent = contentTitle;
                if (modalDescription) modalDescription.innerHTML = '<span class="loading-spinner"></span> Generating enhanced description...';
                if (descriptionModal) {
                    descriptionModal.classList.remove('hidden');
                    descriptionModal.style.display = 'flex';
                }

                const prompt = `Enhance the following content description for a professional digital solutions website (BSRSDigital), making it more engaging, detailed, and appealing to potential learners/readers. Elaborate on the benefits and what users will achieve.
                Content Title: "${contentTitle}"
                Original Description: "${originalDescription}"`;

                const enhancedDescription = await callGeminiAPI(prompt);
                if (modalDescription) modalDescription.textContent = enhancedDescription;
            });
        });

        if (closeModalBtn && descriptionModal) {
            closeModalBtn.addEventListener('click', () => {
                descriptionModal.classList.add('hidden');
                descriptionModal.style.display = 'none';
            });
        }
        
        if (descriptionModal) {
            window.addEventListener('click', (event) => {
                if (event.target == descriptionModal) {
                    descriptionModal.classList.add('hidden');
                    descriptionModal.style.display = 'none';
                }
            });
        }


        // Login/Register Modal Functions
        const loginRegisterModal = document.getElementById('loginRegisterModal');
        const closeLoginRegisterModalBtn = document.getElementById('closeLoginRegisterModalBtn');

        // Function to open the login/register modal
        function openLoginRegisterModal() {
            const authMessage = document.getElementById('authMessage');
            if (authMessage) authMessage.textContent = ''; // Clear previous messages

            const authTitle = document.getElementById('authTitle');
            if (authTitle) authTitle.textContent = 'Sign in to BSRSDigital'; // Set title for Google login

            if (loginRegisterModal) {
                loginRegisterModal.classList.remove('hidden');
                loginRegisterModal.style.display = 'flex';
            }
        }
        window.openLoginRegisterModal = openLoginRegisterModal; // Make it globally accessible

        if (closeLoginRegisterModalBtn && loginRegisterModal) {
            closeLoginRegisterModalBtn.addEventListener('click', () => {
                loginRegisterModal.classList.add('hidden');
                loginRegisterModal.style.display = 'none';
            });
        }

        if (loginRegisterModal) {
            window.addEventListener('click', (event) => {
                if (event.target == loginRegisterModal) {
                    loginRegisterModal.classList.add('hidden');
                    loginRegisterModal.style.display = 'none';
                }
            });
        }

        // Contact Modal Functions
        const contactModal = document.getElementById('contactModal');
        const closeContactModalBtn = document.getElementById('closeContactModalBtn');

        // Function to open the contact modal
        function openContactModal() {
            if (contactModal) {
                contactModal.classList.remove('hidden');
                contactModal.style.display = 'flex';
            }
            // Close mobile menu if open
            const mobileMenu = document.getElementById('mobileMenu');
            if (mobileMenu && !mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.add('hidden');
            }
        }
        window.openContactModal = openContactModal; // Make it globally accessible

        if (closeContactModalBtn && contactModal) {
            closeContactModalBtn.addEventListener('click', () => {
                contactModal.classList.add('hidden');
                contactModal.style.display = 'none';
            });
        }

        if (contactModal) {
            window.addEventListener('click', (event) => {
                if (event.target == contactModal) {
                    contactModal.classList.add('hidden');
                    contactModal.style.display = 'none';
                }
            });
        }

        // --- START: CHATBOT LOGIC INTEGRATION ---
        const neuraXChatbotWidget = document.getElementById('neuraXChatbotWidget');
        const openChatbotFab = document.getElementById('openChatbotFab');
        const chatInput = document.getElementById('chatInput');
        const chatSendButton = document.getElementById('chatSendButton');
        const chatMessages = document.getElementById('chatMessages');

        const SYSTEM_PROMPT = "You are a lady acting as a pleasing assistant. Your answers must be as short and concise as possible. Keep responses to one or two sentences maximum.";
        let conversationHistory = [];

        // Function to get bot response from Gemini API
        async function getBotResponse(history, retries = 0) {
            // Simple token budget: keep only the last 10 messages to manage context size
            const cappedHistory = history.slice(-10);

            const payload = {
                contents: cappedHistory,
                systemInstruction: {
                    parts: [{ text: SYSTEM_PROMPT }]
                },
            };
            const apiKey = ""; // This will be handled by the environment
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    if (response.status === 429 && retries < 5) {
                        const delay = Math.pow(2, retries) * 1000;
                        await new Promise(res => setTimeout(res, delay));
                        return getBotResponse(history, retries + 1);
                    }
                    throw new Error(`API Error: ${response.status}`);
                }

                const result = await response.json();
                if (result.candidates && result.candidates[0].content.parts) {
                    return result.candidates[0].content.parts[0].text;
                }
                return "I'm sorry, I couldn't process that. Could you try again?";
            } catch (error) {
                console.error("Chatbot API call failed:", error);
                return "There was an error connecting to the assistant. Please check the console.";
            }
        }

        // Function to add a message to the chat UI
        function addMessageToUI(sender, text) {
            const messageDiv = document.createElement('div');
            if (sender === 'user') {
                messageDiv.className = 'chat-message-user';
                messageDiv.textContent = text;
            } else if (sender === 'bot') {
                messageDiv.className = 'chat-message-bot';
                messageDiv.textContent = text;
            } else { // for loading indicator
                messageDiv.className = 'chat-message-bot loading';
                messageDiv.innerHTML = '<div class="dot"></div><div class="dot"></div><div class="dot"></div>';
                messageDiv.id = 'loading-indicator';
            }
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return messageDiv;
        }

        // Main function to handle sending a message
        async function sendMessage() {
            const userMessage = chatInput.value.trim();
            if (!userMessage) return;

            // 1. Add user message to UI and history
            addMessageToUI('user', userMessage);
            conversationHistory.push({ role: "user", parts: [{ text: userMessage }] });
            chatInput.value = '';

            // 2. Show loading indicator
            addMessageToUI('loading');

            // 3. Get bot response
            const botResponse = await getBotResponse(conversationHistory);

            // 4. Remove loading indicator
            const loadingIndicator = document.getElementById('loading-indicator');
            if (loadingIndicator) {
                loadingIndicator.remove();
            }

            // 5. Add bot response to UI and history
            addMessageToUI('bot', botResponse);
            conversationHistory.push({ role: "model", parts: [{ text: botResponse }] });

            // 6. Save session
            saveSession();
        }

        // Session management functions
        function saveSession() {
            sessionStorage.setItem('chatHistory', JSON.stringify(conversationHistory));
        }

        function loadSession() {
            const savedHistory = sessionStorage.getItem('chatHistory');
            if (savedHistory) {
                conversationHistory = JSON.parse(savedHistory);
                chatMessages.innerHTML = ''; // Clear existing messages
                conversationHistory.forEach(msg => {
                    // Gemini uses 'model' for the assistant role
                    const role = msg.role === 'model' ? 'bot' : 'user';
                    addMessageToUI(role, msg.parts[0].text);
                });
            } else {
                 // Start with a fresh welcome message if no history
                chatMessages.innerHTML = '';
                addMessageToUI('bot', "Welcome to BSRSDigital! I'm your pleasing assistant. How can I help you today?");
            }
        }

        // Function to toggle chatbot visibility
        function toggleChatbot() {
            if (neuraXChatbotWidget) {
                neuraXChatbotWidget.classList.toggle('hidden');
                neuraXChatbotWidget.classList.toggle('open');
            }
        }
        window.toggleChatbot = toggleChatbot;

        // Event Listeners
        if (openChatbotFab) {
            openChatbotFab.addEventListener('click', toggleChatbot);
        }
        if (chatSendButton) {
            chatSendButton.addEventListener('click', sendMessage);
        }
        if (chatInput) {
            chatInput.addEventListener('keypress', (event) => {
                if (event.key === 'Enter') {
                    sendMessage();
                }
            });
        }
        
        // Initialize chat session on page load
        loadSession();
        // --- END: CHATBOT LOGIC INTEGRATION ---

    </script>
</body>
</html>
